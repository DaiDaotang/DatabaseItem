<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>赛事查询</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="layui/css/layui.css"  media="all">
  <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
</head>
<body>
	<div class="layui-tab">
        <ul class="layui-tab-title">
            <li class="layui-this">赛事查询</li>
            <li>运动员查询</li>
            <li>团队查询</li>
        </ul>
        <div class="layui-tab-content">
            <div class="layui-tab-item layui-show">
				<fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
					<legend>赛事查询</legend>
				</fieldset>
				<div style="width: 100%; position: relative;left:11%;">
				<form class="layui-form layui-form-pane" action="" id="searchForm">
					<div class="layui-form-item">
						<div class="layui-input-inline">
							<select name="gender_select" lay-filter="select_gender">
								<option value="">请选择性别</option>
								<option value="男">男</option>
								<option value="女">女</option>
							</select>
						</div>
						<label class="layui-form-label">项目</label>
						<div class="layui-input-inline">
							<select name="item_select" id="select_item" lay-filter="select_item"></select>
						</div>
						<div class="layui-input-inline">
							<select name="age_select" id="select_age" lay-filter="select_age">
								<option value="7-8">7-8岁</option>
								<option value="9-10">9-10岁</option>
								<option value="11-12">11-12岁</option>
							</select>
						</div>
						<div class="layui-input-inline">
							<button class="layui-btn" lay-submit="" lay-filter="find_btn"><i class="layui-icon layui-icon-search"></i></button>
						</div>
					</div>
				</form>
				</div>
				<div style="text-align: center;">
					<div class="layui-input-inline">
						<table class="layui-hide" id="gameType" lay-filter="gameType"></table>
					</div>
					<div class="layui-input-inline">
						<table class="layui-hide" name="playerDetails" id="playerDetails" lay-filter="playerDetails"></table>
					</div>
				</div>
			</div>
			
			
			<div class="layui-tab-item">
				<fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
					<legend>运动员查询</legend>
				</fieldset>
				<div style="width: 100%; position: relative;left:11%;">
				<form class="layui-form layui-form-pane" action="" id="searchForm">
					<div class="layui-form-item">
						<label class="layui-form-label">运动员</label>
						<div class="layui-input-inline">
							<input class="layui-input" name="athlete_input" id="athlete_input"></input>
						</div>
						<div class="layui-input-inline">
							<button class="layui-btn" lay-submit="" lay-filter="find_btn_ath"><i class="layui-icon layui-icon-search"></i></button>
						</div>
					</div>
				</form>
				</div>
				<div style="text-align: center;">
					<div class="layui-input-inline">
						<table class="layui-hide" name="playerDetails_pname" id="playerDetails_pname" lay-filter="playerDetails_pname"></table>
					</div>
				</div>

			</div>
			
			
			<div class="layui-tab-item">
				<fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
					<legend>代表队查询</legend>
				</fieldset>
				<div style="width: 100%; position: relative;left:11%;">
				<form class="layui-form layui-form-pane" action="" id="searchForm">
					<div class="layui-form-item">
						<label class="layui-form-label">代表队名</label>
						<div class="layui-input-inline">
							<input class="layui-input" name="team_input" id="team_input"></input>
						</div>
						<div class="layui-input-inline">
							<button class="layui-btn" lay-submit="" lay-filter="find_btn_team"><i class="layui-icon layui-icon-search"></i></button>
						</div>
					</div>
				</form>
				</div>
				<div style="text-align: center;">
					<div class="layui-input-inline">
						<table class="layui-hide" id="team" lay-filter="team"></table>
					</div>
				</div>
			</div>
		</div>
	</div>	
          
	<script src="layui/layui.js" charset="utf-8"></script>
	<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 --> 
 
	<script>
	
		var result = [
			""    //itemName 0
			,""   //sex		1
			,"7-8"//age		2
			,[]
			,""   //com_id	4
			,""   //ath_name	5
			,""   //team_name	6
		];
		
		//url 可能要重新写
		var param_gameType = function(res){return{
			elem: '#gameType'
			,id:'table_gameType'
			,url:'http://localhost:8080/CheckSchedule'
			,title:'组别表'
			,contentType:'application/json'
			,method:"POST"
            , deal: function (res) {
                console.log(res);
				return{
					code:0,msg:"",count:1000,data:res.resData
				}
			}
			,where:{
				"reqId":"",
				"reqParam":{
<<<<<<< HEAD
					"itemName":res[0],
					"age":res[2],
					"sex":res[1]
				}
=======
					itemName:result[0],
					age:result[2],
					sex:result[1]
                },
                "reqPageInfo": {
                    "pageSize": 1000
                }
>>>>>>> 02715067d4610ee1e4643d33ef64d5c4331eb1a8
			}
			,cols: [[
				{type:'radio'}
				,{field:'com_id', width:120, title: '组号'}
				,{field:'ref_group_id', width:80, title: '裁判组'}
				,{field:'time', width:200, title: '时间'}
				,{field:'amount', width:120, title: '人数'}
			]]
			,page: false
		}};

  
		var param_playerDetails = function(res){return{
			elem: '#playerDetails'
			,id:'table_playerDetails'
			,url:'http://localhost:8080/GetResultByItem'
			,title:'运动员列表'
			,contentType:'application/json'
			,method:"POST"
            , deal: function (res) {
                console.log(res);
				return{
					code:0,msg:"",count:1000,data:res.resData
				}
			}
			,where:{
				"reqId":"",
				"reqParam":{
					"itemName":res[0],
					"ageDelivery":res[2],
					"sex":res[1],
					"com_id":res[4]
					//组号
                },
                "reqPageInfo":{
                    "pageSize":1000
                }
			}
			,cols: [[
				
				{field:'ath_id', width:120, title: '运动员编号'}
				,{field:'ath_name', width:120, title: '运动员'}
				,{field:'team_name', width:120, title: '队伍'}
				,{field:'type', width:120, title: '类型'}
				,{field:'rank', width:80, title: '排名', sort: true}
				,{field:'result', width:120, title: '成绩', sort: true}
			]]
			,page: false
		}};
		
		var param_playerDetails_pname = function(res){return{
			elem: '#playerDetails_pname'
			,id:'table_playerDetails_pname'
			,url:'http://localhost:8080/GetResultByAthlete'
			,title:'运动员列表'
			,contentType:'application/json'
			,method:"POST"
			,deal:function(res){
				return{
					code:0,msg:"",count:1000,data:res.resData
				}
			}
			,where:{
				"reqId":"",
				"reqParam":{
					"ath_name":res[5]
				}
			}
			,cols: [[
				{field:'ath_id', width:120, title: '运动员编号'}
				,{field:'ath_name', width:120, title: '运动员'}
				,{field:'team_name', width:120, title: '队伍'}
				,{field:'item_name', width:150, title: '比赛'}
				,{field:'type', width:120, title: '类型'}
				,{field:'rank', width:80, title: '排名'}
				,{field:'result', width:120, title: '成绩'}
			]]
			,page: false
		}};
		
		var param_team = function(res){return{
			elem: '#team'
			,id:'team'
			,url:'http://localhost:8080/GetResultByTeam'
			,title:'队伍列表'
			,contentType:'application/json'
			,method:"POST"
			,deal:function(res){
				return{
					code:0,msg:"",count:1000,data:res.resData
				}
			}
			,where:{
				"reqId":"",
				"reqParam":{
					"team_name":res[6]
				}
			}
			,cols: [[
				{field:'team_name', width:120, title: '队伍'}		
				,{field:'ath_id', width:120, title: '运动员编号'}
				,{field:'ath_name', width:120, title: '运动员'}
				,{field:'item_name', width:120, title: '项目'}
				,{field:'type', width:80, title: '类型'}
				,{field:'rank', width:120, title: '排名'}
				,{field:'result', width:120, title: '成绩'}
				,{field:'team_rank', width:120, title: '代表队名次'}
			]]
			,page: false
		}};
		
		
		 //元素
		layui.use('element', function () {
			var $ = layui.jquery
				, element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块
		});		
		
		//form区
        layui.use(['form', 'table','layedit'],  function () {
            var form = layui.form
                , layer = layui.layer
                , table = layui.table
                , $ = layui.$
                , layedit = layui.layedit;

            var editIndex = layedit.build('LAY_demo_editor');

			
			
            //监听项目查询
            form.on('submit(find_btn)', function (data) {
				result[3] = [];
				console.log(result);
				table.render(param_gameType(result));
				table.render(param_playerDetails(result));
                window.event.returnValue = false;

				return false;
            });
			
			//监听运动员查询
            form.on('submit(find_btn_ath)', function (data) {
				result[3] = [];
				console.log(data.field.athlete_input);
				result[5]=data.field.athlete_input;
				console.log(result);
				table.render(param_playerDetails_pname(result));
                window.event.returnValue = false;
				return false;
            });
			
			//监听运动员查询
            form.on('submit(find_btn_team)', function (data) {
				result[3] = [];
				console.log(data.field.team_input);
				result[6]=data.field.team_input;
				console.log(result);
				table.render(param_team(result));
                window.event.returnValue = false;
				return false;
            });
			
			//改变单选框内容
            form.on('select(select_gender)', function (data) {
                console.log(data.value); //得到被选中的值
                result[1] = data.value;
                if (data.value == '男') {
					result[0]="单杠";
                    document.getElementById('select_item').innerHTML = "<option value='单杠'>单杠</option><option value='双杠'>双杠</option><option value='吊环'>吊环</option><option value='跳马'>跳马</option><option value='自由体操'>自由体操</option><option value='鞍马'>鞍马</option><option value='蹦床'>蹦床</option>"
                    result[0] = "单杠";
                    form.render('select');
                } else if (data.value == '女') {
					result[0]="跳马";
                    document.getElementById('select_item').innerHTML = "<option value='跳马'>跳马</option><option value='高低杠'>高低杠</option><option value='平衡木'>平衡木</option><option value='自由体操'>自由体操</option><option value='蹦床'>蹦床</option>"
                    result[0] = "跳马";
                    form.render('select');
                }
                
            });
			
			//获得下拉查询条件
			form.on('select(select_item)', function (data) {
                result[0] = data.value;
                console.log(data.value);
                console.log(result[0]);
            });
			
            form.on('select(select_age)', function (data) {
                result[2] = data.value;
				console.log(result[2]);
            });
			
			//表单初始赋值
            form.val('searchForm', {
                "select_gender": ""
                , "select_item": ""
                , "select_age": "7-8"
            });
			
			//获取radio行的数据
			table.on("radio(gameType)",function(data){
				console.log(data.data)
				result[4] = data.data.com_id;
				table.render(param_playerDetails(result));
				
			});
            
		});
  
	</script>

</body>
</html>